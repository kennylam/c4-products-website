language: node_js

node_js:
  - '10'

cache:
  directories:
    - node_modules

notifications:
  slack:
    rooms:
    - ibm-casdesign:P44xeoRDixDw38uE025Qoekz
    on_pull_requests: false
    on_success: change
    on_failure: always
    template:
    - "`%{repository_name}` *%{result}* build <%{build_url}|#%{build_number}>"
    - "Commit #<%{compare_url}|%{commit}> %{commit_message}"
    - "Author: *%{author}*"
    - "Execution time: *%{duration}*"
    - "Message: %{message}"
  email: false

script: skip

stages:
  - "deploy"

jobs:
  fast_finish: true
  include:
  - stage: "deploy"
    script:
    - yarn build
    deploy:
      provider: pages
      skip_cleanup: true
      github_token: $GITHUB_TOKEN # Set in the settings page of your repository, as a secure variable
      github_url: github.ibm.com
      local_dir: public
      on:
        branch: master
